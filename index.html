<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Portail des jeux vid√©os Melomuse</title>
<style>
  :root { --bg:#0f1115; --card:#171923; --text:#eef2f7; --muted:#a6b0bf; --accent:#7dd3fc; --ok:#34d399; --err:#fca5a5; }
  *{box-sizing:border-box}
  /* Base + tailles renforc√©es pour l‚Äôaccessibilit√© (encore +) */
  body{
    margin:0;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",sans-serif;
    background:radial-gradient(1200px 1200px at 80% -200px,#1f2937 10%,#0f1115 70%);
    color:var(--text);
    min-height:100svh;
    display:grid;
    place-items:center;
    padding:32px;
    font-size:20px;        /* ‚Üë */
    line-height:1.6;
  }
  .card{
    width:100%;
    max-width:1080px;      /* ‚Üë */
    background:linear-gradient(180deg,#1b1f2a 0,#12141b 100%);
    border:1px solid #2a2f3d;
    border-radius:22px;
    box-shadow:0 14px 40px rgba(0,0,0,.38);
    overflow:hidden;
  }
  header{padding:28px 28px 0;display:flex;gap:16px;align-items:center;justify-content:space-between}
  .hgroup{display:flex;gap:14px;align-items:center}
  .logo{width:56px;height:56px;border-radius:14px;background:conic-gradient(from 0deg,#60a5fa,#a78bfa,#34d399,#60a5fa);filter:saturate(120%)}
  h1{margin:0;font-size:28px;letter-spacing:.2px}
  .sub{margin:6px 0 0;color:var(--muted);font-size:18px}
  .logout{
    display:none;          /* visible apr√®s connexion */
    padding:12px 16px;border:1px solid #2a2f3d;background:#171923;color:var(--text);
    border-radius:12px;cursor:pointer;font-size:18px
  }
  .logout:focus{outline:3px solid var(--accent);outline-offset:2px}

  main{padding:28px}
  .gate{display:grid;gap:16px;margin:10px 0 24px}
  label{font-size:18px;color:var(--muted)}
  input[type=password]{
    width:100%;padding:16px 18px;border:1px solid #2a2f3d;border-radius:16px;
    background:#0f1115;color:var(--text);outline:none;font-size:20px;
  }
  input[type=password]:focus{border-color:var(--accent);box-shadow:0 0 0 4px rgba(125,211,252,.2)}
  button{
    padding:14px 18px;border:1px solid #2a2f3d;background:#171923;color:var(--text);
    border-radius:14px;cursor:pointer;font-size:18px
  }
  button:focus{outline:3px solid var(--accent);outline-offset:2px}
  .row{display:flex;gap:14px;flex-wrap:wrap}
  .err{color:var(--err);font-size:16px;min-height:1.2em}
  .ok{color:var(--ok);font-size:16px;min-height:1.2em}
  .links{display:none;margin-top:12px}
  .grid{display:grid;gap:18px}
  @media (min-width:760px){.grid{grid-template-columns:1fr 1fr}}
  .tile{
    border:1px solid #2a2f3d;border-radius:18px;padding:18px;background:linear-gradient(180deg,#161925,#12141b);
    display:flex;flex-direction:column;gap:10px
  }
  .tile h3{margin:0;font-size:20px}
  .tile p{margin:0;color:var(--muted);font-size:17px}
  .tile a{
    margin-top:auto;display:inline-block;padding:14px 16px;border-radius:14px;border:1px solid #2a2f3d;
    text-decoration:none;color:var(--text);font-size:18px;text-align:center
  }
  .tile a:focus{outline:3px solid var(--accent);outline-offset:2px}
</style>
</head>
<body>
  <div class="card" role="region" aria-labelledby="title">
    <header>
      <div class="hgroup">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1 id="title">Portail des jeux vid√©os Melomuse</h1>
          <p class="sub">Espace d√©mo (pr√©sentiel & distanciel)</p>
        </div>
      </div>
      <button id="logout" class="logout" type="button" aria-label="Se d√©connecter">D√©connexion</button>
    </header>

    <main>
      <form id="gateForm" class="gate" novalidate>
        <div>
          <label for="pass">Mot de passe atelier</label>
          <input id="pass" name="pass" type="password" autocomplete="current-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" aria-describedby="status" required />
        </div>
        <div class="row">
          <button type="submit">Entrer</button>
          <button type="button" id="show" aria-pressed="false" aria-controls="pass">Afficher</button>
        </div>
        <div id="status" class="err" role="status" aria-live="polite"></div>
        <div id="okmsg" class="ok" role="status" aria-live="polite"></div>
      </form>

      <section id="links" class="links" aria-label="Jeux disponibles">
        <div class="grid">
          <article class="tile">
            <h3>üéµ L‚ÄôOreille Magique</h3>
            <p>√âcoute active & m√©moire auditive</p>
            <a href="https://xd.adobe.com/view/6a005724-876a-4236-b689-8b9d5860feb1-3f53/" target="_blank" rel="noopener">Ouvrir</a>
          </article>
          <article class="tile">
            <h3>üü¶ Simon</h3>
            <p>S√©quences sons & couleurs</p>
            <a href="https://carwars.github.io/melomuse-simon/" target="_blank" rel="noopener">Ouvrir</a>
          </article>
          <article class="tile">
            <h3>‚õ∞Ô∏è L‚ÄôEscalier des hauteurs</h3>
            <p>Associer la note jou√©e √† la bonne marche</p>
            <a href="https://carwars.github.io/melomuse-escalierdeshauteurs/" target="_blank" rel="noopener">Ouvrir</a>
          </article>
          <article class="tile">
            <h3>üÉè Jeu des cartes</h3>
            <p>Cartes corporelles & visuelles (musicoth√©rapie)</p>
            <a href="https://xd.adobe.com/view/8b1d5a42-5b18-418a-8c65-a8c1c53f8dcd-de4e/?fullscreen" target="_blank" rel="noopener">Ouvrir</a>
          </article>
        </div>
      </section>
    </main>
  </div>

<script>
/** CONFIG ‚Äî mot de passe actuel = "melomuse2025" */
const PASSWORD_HASH = "17f84ead6b4df1adade21da5d4e5fe0f682b2f6265aa462e720b2ddcd43c47d5";

/* (optionnel) Restreindre par session : ajouter ?session=AAAA-MM-JJ au QR et mettre la m√™me valeur ici */
const REQUIRED_SESSION = null; // ex: "2025-09-06"

const $pass   = document.getElementById('pass');
const $status = document.getElementById('status');
const $okmsg  = document.getElementById('okmsg');
const $links  = document.getElementById('links');
const $form   = document.getElementById('gateForm');
const $show   = document.getElementById('show');
const $logout = document.getElementById('logout');

$show.addEventListener('click', () => {
  const on = $pass.type === 'password';
  $pass.type = on ? 'text' : 'password';
  $show.setAttribute('aria-pressed', String(on));
  $show.textContent = on ? 'Masquer' : 'Afficher';
  $pass.focus();
});

$form.addEventListener('submit', async (e) => {
  e.preventDefault();
  $status.textContent = "";
  $okmsg.textContent = "";
  const pwd = $pass.value.trim();
  if (!pwd) { $status.textContent = "Entre le mot de passe."; return; }

  if (REQUIRED_SESSION) {
    const url = new URL(location.href);
    if (url.searchParams.get("session") !== REQUIRED_SESSION) {
      $status.textContent = "Lien de session invalide ou expir√©.";
      return;
    }
  }

  const enc  = new TextEncoder().encode(pwd);
  const hbuf = await crypto.subtle.digest("SHA-256", enc);
  const hash = Array.from(new Uint8Array(hbuf)).map(b=>b.toString(16).padStart(2,"0")).join("");

  if (hash === PASSWORD_HASH) {
    unlock();
  } else {
    $status.textContent = "Mot de passe incorrect.";
    $pass.select();
  }
});

// D√©connexion : vide la session et r√©affiche le formulaire
$logout.addEventListener('click', () => {
  sessionStorage.removeItem('melomuse_ok');
  lock();
  $pass.focus();
});

// Auto-d√©verrouillage si d√©j√† valid√© durant la session
if (sessionStorage.getItem('melomuse_ok') === '1') {
  unlock(true);
}

// Accessibilit√© : Enter soumet, Escape efface
$pass.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') { $pass.value=""; $status.textContent=""; }
});

function unlock(fromSession=false){
  $links.style.display = 'block';
  $form.style.display  = 'none';
  $logout.style.display = 'inline-block';
  if (!fromSession) sessionStorage.setItem('melomuse_ok', '1');
  $okmsg.textContent = "Acc√®s autoris√©. Bonne d√©mo !";
}

function lock(){
  $links.style.display = 'none';
  $form.style.display  = 'grid';
  $logout.style.display = 'none';
  $okmsg.textContent   = "";
  $status.textContent  = "";
}
</script>
</body>
</html>

